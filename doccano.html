<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NotebookLM - Document Annotation Page</title>

    <!-- Meta Tags -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https: data:; img-src 'self' https: data:; connect-src 'self' https:;"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Alpine.js with persistence plugin -->
    <script src="https://cdn.jsdelivr.net/npm/@alpinejs/persist@3.x.x/dist/cdn.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
      defer
    ></script>

    <!-- Main application script (must load after Alpine.js) -->
    <script type="module" src="./js/doccano.js"></script>
    <script src="./js/app.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./css/app.css" />
    <link rel="stylesheet" href="./css/doccano.css" />
    <link rel="stylesheet" href="./css/tour.css" />
  </head>

  <body
    class="h-screen flex flex-col bg-eu-white font-sans text-text-primary overflow-hidden"
    style="--tw-bg-opacity: 1"
    x-data="{
      ...appInfrastructure,
      profileDropdownOpen: false,
      activeTab: 'document',
      handleDropdownMenuItemClick(action) {
        this.profileDropdownOpen = false;
        // Handle menu item click actions here
        switch(action) {
          case 'profile':
            window.location.href = './profile.html';
            break;
          case 'settings':
            window.location.href = './settings.html';
            break;
          case 'signout':
            // Handle sign out logic here
            console.log('Signing out...');
            break;
        }
      }
    }"
  >
    <!-- Preloader -->
    <div
      id="preloader"
      class="fixed inset-0 z-50 flex items-center justify-center bg-eu-blue transition-opacity duration-500"
      x-show="preloaderVisible"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
    >
      <div
        class="animate-spin rounded-full h-12 w-12 border-b-2 border-eu-orange"
        aria-label="Loading"
      ></div>
    </div>
    <!-- Mobile Header (visible on small screens) -->
    <div class="lg:hidden bg-[#003087] shadow-md z-10 w-full">
      <!-- Top Row: Logo and Profile -->
      <div class="flex items-center justify-between px-4 py-3">
        <!-- Logo -->
        <a href="./index.html" class="flex items-center flex-shrink-0">
          <img
            src="./images/rgb-logo_white_onblue.svg"
            alt="Logo"
            class="h-10 w-10"
          />
          <span class="ml-2 text-eu-white text-lg font-semibold whitespace-nowrap">
            Notebook LLM
          </span>
        </a>

        <!-- Profile Button -->
        <div class="relative">
          <button
            @click.stop="profileDropdownOpen = !profileDropdownOpen"
            class="p-1 focus:outline-none"
            aria-expanded="false"
            aria-haspopup="true"
          >
            <span class="sr-only">Open user menu</span>
            <div class="relative">
              <div class="absolute inset-0 rounded-full transition-all duration-200" :class="{ 'ring-2 ring-eu-orange': profileDropdownOpen, 'ring-2 ring-white': !profileDropdownOpen }"></div>
              <img
                class="h-8 w-8 rounded-full"
                src="https://ui-avatars.com/api/?name=Peter+Thirikwa&background=003087&color=fff&rounded=true&size=40"
                alt="Profile"
              >
            </div>
          </button>

          <!-- Dropdown menu -->
          <div
            x-show="profileDropdownOpen"
            @click.away="profileDropdownOpen = false"
            class="origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50"
            role="menu"
            aria-orientation="vertical"
            x-transition:enter="transition ease-out duration-100"
            x-transition:enter-start="transform opacity-0 scale-95"
            x-transition:enter-end="transform opacity-100 scale-100"
            x-transition:leave="transition ease-in duration-75"
            x-transition:leave-start="transform opacity-100 scale-100"
            x-transition:leave-end="transform opacity-0 scale-95"
          >
            <div class="py-1" role="none">
              <div class="px-4 py-3 border-b border-gray-100">
                <p class="text-xs text-gray-500">Welcome back,</p>
                <p class="text-sm font-medium text-gray-900 truncate">Peter Thirikwa</p>
                <p class="text-xs text-gray-500 truncate">peter@rgb.co.tz</p>
              </div>
              <a
                href="#"
                class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
                role="menuitem"
                @click.stop="handleDropdownMenuItemClick('profile')"
              >
                <i class="fas fa-user-circle w-5 text-center text-eu-blue mr-3"></i>
                <span>My Profile</span>
              </a>
              <a
                href="#"
                class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
                role="menuitem"
                @click.stop="handleDropdownMenuItemClick('settings')"
              >
                <i class="fas fa-cog w-5 text-center text-eu-blue mr-3"></i>
                <span>Settings</span>
              </a>
              <div class="border-t border-gray-100 my-1"></div>
              <a
                href="#"
                class="flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50"
                role="menuitem"
                @click.stop="handleDropdownMenuItemClick('signout')"
              >
                <i class="fas fa-sign-out-alt w-5 text-center text-red-500 mr-3"></i>
                <span>Sign out</span>
              </a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Bottom Row: Page Title -->
      <div class="bg-[#003087] border-t border-[#1a4b9a] px-4 py-2">
        <h1 class="text-lg font-bold text-eu-white text-center">
          Document Annotation Page
        </h1>
      </div>
    </div>

    <!-- Desktop Header (hidden on mobile) -->
    <header class="hidden lg:flex px-4 py-3 bg-[#003087] shadow-md z-10 w-full">
      <div class="flex items-center justify-between w-full">
        <!-- Logo and name on the left -->
        <div class="flex-shrink-0">
          <a href="./index.html" class="flex items-center group">
            <div class="relative">
              <img
                src="./images/rgb-logo_white_onblue.svg"
                alt="Logo"
                class="h-10 w-10 lg:h-12 lg:w-12 rounded-full transform transition-transform duration-300 group-hover:rotate-12"
              />
              <div class="absolute inset-0 rounded-full border-2 border-transparent group-hover:border-eu-orange transition-all duration-300"></div>
            </div>
            <span class="ml-3 text-eu-white text-lg lg:text-xl font-semibold transition-colors duration-200 hover:text-eu-orange">
              Notebook LLM
            </span>
          </a>
        </div>

        <!-- Title in the center with hover effect -->
        <div class="flex-1 flex justify-center px-4">
          <h1 class="text-xl lg:text-2xl font-bold text-eu-white whitespace-nowrap transition-all duration-300 transform hover:scale-105 hover:text-eu-orange">
            Document Annotation Page
          </h1>
        </div>

        <!-- Icons and profile on the right -->
        <div class="flex items-center space-x-6">
          <div class="flex items-center space-x-5">
            <button class="text-eu-white hover:text-eu-orange transition-colors" title="Help">
              <i class="fas fa-question-circle text-xl"></i>
            </button>
            <button class="text-eu-white hover:text-eu-orange transition-colors relative" title="Notifications">
              <i class="fas fa-bell text-xl"></i>
              <span class="absolute -top-1 -right-1 h-2 w-2 rounded-full bg-eu-orange"></span>
            </button>
          </div>

          <!-- Profile dropdown -->
          <div class="relative">
            <button
              @click.stop="profileDropdownOpen = !profileDropdownOpen"
              class="p-1 focus:outline-none group"
              :class="{'ring-2 ring-eu-orange': profileDropdownOpen}"
            >
              <div class="relative">
                <!-- Background circle with hover/active states -->
                <div class="relative h-10 w-10 flex items-center justify-center">
                  <!-- Hover background -->
                  <div class="absolute inset-0 rounded-full bg-eu-orange/0 group-hover:bg-eu-orange/10 transition-colors duration-200"></div>
                  
                  <!-- Active state background -->
                  <div 
                    class="absolute inset-0 rounded-full transition-opacity duration-200"
                    :class="{'bg-eu-orange/20': profileDropdownOpen}"
                  ></div>
                  
                  <!-- Border ring -->
                  <div 
                    class="absolute inset-0 rounded-full ring-1 ring-white/50 group-hover:ring-2 group-hover:ring-eu-orange transition-all duration-200"
                    :class="{'ring-2 ring-eu-orange': profileDropdownOpen}"
                  ></div>
                  
                  <!-- Profile image -->
                  <img
                    src="https://ui-avatars.com/api/?name=Peter+Thirikwa&background=003087&color=fff&rounded=true&size=40"
                    class="h-8 w-8 rounded-full object-cover transition-transform duration-200 group-hover:scale-105"
                    alt="Profile"
                  />
                </div>
              </div>
            </button>

            <!-- Dropdown menu -->
            <div
              x-show="profileDropdownOpen"
              @click.away="profileDropdownOpen = false"
              class="absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl z-50 border border-eu-blue/10 overflow-hidden"
              x-transition:enter="transition ease-out duration-100"
              x-transition:enter-start="transform opacity-0 scale-95"
              x-transition:enter-end="transform opacity-100 scale-100"
              x-transition:leave="transition ease-in duration-75"
              x-transition:leave-start="transform opacity-100 scale-100"
              x-transition:leave-end="transform opacity-0 scale-95"
            >
              <!-- Welcome Message -->
              <div class="px-4 py-3 border-b border-gray-100">
                <p class="text-xs text-gray-500 mb-1">Welcome back,</p>
                <p class="text-sm font-medium text-gray-900 truncate">
                  Peter Thirikwa
                </p>
                <p class="text-xs text-gray-500 truncate">peter@rgb.co.tz</p>
              </div>

              <!-- Menu Items -->
              <div class="py-1" role="menu" aria-orientation="vertical">
                <a
                  href="#"
                  class="flex items-center px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
                  role="menuitem"
                  @click.stop="handleDropdownMenuItemClick('profile')"
                >
                  <i
                    class="fas fa-user-circle w-5 text-center text-eu-blue mr-3"
                  ></i>
                  <span>My Profile</span>
                </a>
                <a
                  href="#"
                  class="flex items-center px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
                  role="menuitem"
                  @click.stop="handleDropdownMenuItemClick('settings')"
                >
                  <i class="fas fa-cog w-5 text-center text-eu-blue mr-3"></i>
                  <span>Settings</span>
                </a>
                <div class="border-t border-gray-100 my-1"></div>
                <a
                  href="#"
                  class="flex items-center px-4 py-2.5 text-sm font-medium text-red-500 hover:bg-red-50 hover:text-red-600 transition-colors"
                  role="menuitem"
                  @click.stop="handleDropdownMenuItemClick('signout')"
                >
                  <i class="fas fa-sign-out-alt w-5 text-center mr-3"></i>
                  <span>Sign out</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content Wrapper -->
    <div id="main-content-wrapper" class="relative flex-1 flex flex-col overflow-hidden">
      <!-- Main Content Container - This will be behind the dropdowns -->
      <div id="main-content" class="flex-1 flex flex-col overflow-hidden relative z-0">
        <!-- Mobile Tabs -->
        <div class="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-40">
        <div class="flex justify-around">
          <button
            class="flex flex-col items-center justify-center py-2 px-4 w-full text-sm font-medium"
            :class="activeTab === 'guide' ? 'text-eu-orange' : 'text-gray-500 hover:text-gray-700'"
            @click="activeTab = 'guide'; switchTab('left-column')"
          >
            <i class="fas fa-book text-lg mb-1"></i>
            <span>Guide</span>
          </button>
          <button
            class="flex flex-col items-center justify-center py-2 px-4 w-full text-sm font-medium"
            :class="activeTab === 'document' ? 'text-eu-orange' : 'text-gray-500 hover:text-gray-700'"
            @click="activeTab = 'document'; switchTab('middle-column')"
          >
            <i class="fas fa-file-alt text-lg mb-1"></i>
            <span>Document</span>
          </button>
          <button
            class="flex flex-col items-center justify-center py-2 px-4 w-full text-sm font-medium"
            :class="activeTab === 'annotation' ? 'text-eu-orange' : 'text-gray-500 hover:text-gray-700'"
            @click="activeTab = 'annotation'; switchTab('right-column')"
          >
            <i class="fas fa-tag text-lg mb-1"></i>
            <span>Annotation</span>
          </button>
        </div>
      </div>

      <!-- Main Content Columns -->
      <div id="columns-container" x-data="{
    isLeftCollapsed: false,
    isRightCollapsed: false
  }">
        
        <!-- Left Column (Guide) -->
        <div id="left-column" class="column" :class="{ 'collapsed': isLeftCollapsed }">
          <!-- Expanded View -->
          <div class="expanded-content">
            <div class="column-header">
              <h2>Guide</h2>
              <button 
                @click="isLeftCollapsed = true"
                class="text-white hover:text-eu-orange active:text-eu-orange transition-colors duration-200"
                title="Collapse panel"
              >
                <i class="fas fa-chevron-left"></i>
              </button>
            </div>
            <div class="scrollable-content">
              <div class="space-y-4">
                <div class="p-3 bg-eu-light-blue/30 rounded-lg border border-eu-blue/20">
                  <h3 class="font-medium text-eu-blue mb-2">Getting Started</h3>
                  <p class="text-sm text-text-secondary">
                    Use the annotation tools to label your documents. Select text and choose a label from the toolbar.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Collapsed View -->
          <div class="collapsed-content">
            <div class="column-header flex justify-center items-center">
              <button 
                @click="isLeftCollapsed = false"
                class="text-white hover:text-eu-orange active:text-eu-orange transition-colors duration-200"
                title="Expand panel"
              >
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Middle Column (Document) -->
        <div id="middle-column" class="column flex-1">
          <div class="column-header">
            <h2>Document</h2>
            <div class="flex items-center">
              <button 
                class="text-eu-blue hover:text-eu-orange active:text-eu-orange p-1 transition-colors duration-200"
                :title="isLeftCollapsed ? 'Show side panels' : 'Expand document view'"
                @click="const newState = !isLeftCollapsed || !isRightCollapsed; isLeftCollapsed = newState; isRightCollapsed = newState;"
              >
                <i :class="isLeftCollapsed ? 'fa-expand-arrows-alt' : 'fa-compress-arrows-alt'" class="fas"></i>
              </button>
            </div>
          </div>
          <div class="scrollable-content">
            <div
              class="flex flex-col h-full overflow-hidden"
              id="document-content"
            >
            </div>
          </div>
        </div>

        <!-- Right Column (Annotations) -->
        <div id="right-column" class="column" :class="{ 'collapsed': isRightCollapsed }">
          <!-- Expanded View -->
          <div class="expanded-content">
            <div class="column-header">
              <h2>Annotations</h2>
              <div class="flex items-center space-x-2">
                <button 
                  @click="isRightCollapsed = true"
                  class="text-white hover:text-eu-orange active:text-eu-orange transition-colors duration-200"
                  title="Collapse panel"
                >
                  <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>
            <div class="scrollable-content">
              <!-- Annotations list will go here -->
              <div class="space-y-3">
                <div class="p-3 bg-eu-light-blue/20 rounded-lg border border-eu-blue/10">
                  <div class="flex justify-between items-start">
                    <span class="text-sm font-medium text-eu-blue">Person</span>
                    <span class="text-xs text-text-secondary">Just now</span>
                  </div>
                  <p class="mt-1 text-sm">John Smith</p>
                </div>
                <div class="p-3 bg-eu-light-blue/20 rounded-lg border border-eu-blue/10">
                  <div class="flex justify-between items-start">
                    <span class="text-sm font-medium text-eu-blue">Organization</span>
                    <span class="text-xs text-text-secondary">2 min ago</span>
                  </div>
                  <p class="mt-1 text-sm">ACME Corp</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Collapsed View -->
          <div class="collapsed-content">
            <div class="column-header flex justify-center items-center">
              <button 
                @click="isRightCollapsed = false"
                class="text-white hover:text-eu-orange active:text-eu-orange transition-colors duration-200"
                title="Expand panel"
              >
                <i class="fas fa-chevron-left"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer with Disclaimer -->
    <p class="text-center text-xs text-gray-500 mb-1">
      NotebookLM can be inaccurate; please double-check its responses.
    </p>

    <!-- Main doccano script (loads other modules) -->
    <!-- <script src="./js/doccano.js" type="module"></script> -->
  </body>
</html>
